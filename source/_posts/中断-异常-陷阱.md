---
title: 中断 异常 陷阱
toc: true
date: 2022-02-18 13:35:21
tags:
categories:
---

https://www.crifan.com/files/doc/docbook/interrupt_related/release/htmls/index.html

<!--more-->

## 中断interrupt

单说中断一般指的是硬件中断，外部设备发生了某些事件，通知CPU，然后CPU跳转到相应的ISR（中断处理程序 interrupt service routine），执行完再回来执行下一条指令。

### 为什么要有中断

针对外设IO的场景：

因为外设IO要远慢与CPU的指令执行速度，CPU指令执行的速度是ns级别的，而外设IO的速度是ms级别的。

假如没有中断要操作外设，CPU一步步按指令顺序执行，CPU给外设发送一个指令，外设开始执行相应的动作，然后CPU开始读取外设的状态，因为CPU指令的执行很快，结果就是CPU执行了多次读取结果的指令（轮询），得到的结果都是外设IO未完成，浪费了CPU时间。

而中断是CPU该干嘛干嘛，不用轮询，等外设的活干完了，再自动发送一个中断给CPU。

轮询poll的含义是：循环等待事件完成

## 异常 exception

异常时当前指令做出了非法操作，不如除0，内存的非法访问

## 陷阱 trap

陷阱又叫软件中断，软件的含义是这种中断是由指令完成的，在x86系统中，就是对应的int指令。CPU执行了int指令，然后跳转到对应的软中断处理函数中，陷阱是软件本身的，是程序员故意实现的，常用用于调试。

## 广义的中断

广义的中断指种植打断正在执行的CPU，所以前面介绍的中断、异常、陷阱都可以叫中断。

### 内部中断和外部中断

细分的话广义的中断可以分为内部中断和外部中断，内部和外部是针对CPU来说的，如果中断是CPU外产生的就是外部中断，其实就是之前介绍的中断（硬件中断，外设产生），内部中断就是CPU本身执行的指令产生的，对应之前介绍的异常和陷阱。

### 向量中断和非向量中断

### 可屏蔽中断和非可屏蔽中断

