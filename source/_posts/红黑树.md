---
title: 红黑树
toc: true
date: 2020-12-16 13:14:54
tags: 数据结构
categories:
- 数据结构
---

<!--more-->

## 红黑树什么用

* 查找key-value，查找性能快
  * 服务器管理连接socketfd（key）与客户端id（value）的映射关系
  * 内核内存管理
* 通过中序遍历，得到顺序结果
  * 进程调度，就绪队列

## 红黑树性质

> 5条

* 每个节点是红的或黑的
* 根节点是黑的
* 每个叶子节点是黑的
* 如果一个节点是红的，那他的两个儿子是黑的
* 对每个节点，从该节点到其子孙节点的所有路径上的包含相同数目的黑节点（黑高相同）

## 缺页中断

先看什么时候要用到红黑树。

对于用户空间的缺页中断，首先从CPU的控制寄存器CR2中读出出错地址address，然后调用find_vma(),在进程的虚拟地址空间中找出结束地址大于address的第一个区间。

这个查找是一个频繁操作，为了加速VMA的检索速度，所以有了红黑树。

根据查找的结果，如果找不到，说明中断是地址越界引起的，转到bad_area执行相关错误处理。如果找到，对页面检查权限，通过后进行页面的分配和交换。

这个查找是针对整个内存还是进程的？？如果是进程的一个进程一棵树？

